//Array.prototype.forEach=function(cb){if(typeof cb!='function'){throw new TypeError()};for(var i=0;i!=this.length;++i){cb.call(this,i,this[i])}};
//Object.prototype.forEach=function(cb){for(var i in this){if(this.hasOwnProperty(i) && typeof cb=='function')cb(i,this[i])}}
/*
 * 需要定义
 * CONFIG = {
		MEDIA : '',
		IMGDIR : '/imgs/',
		'SITEURL' : '',
}
IMGDIR = CONFIG.IMGDIR;
才能运行

 */

var BROWSER = {};
var USERAGENT = navigator.userAgent.toLowerCase();
browserVersion({'ie':'msie','firefox':'','chrome':'','opera':'','safari':'','mozilla':'','webkit':'','maxthon':'','qq':'qqbrowser','rv':'rv'});
if(BROWSER.safari || BROWSER.rv) {
	BROWSER.firefox = true;
}
var MessageJS = {
	'sysError500' : 'system Error',	
	'wating' : 'loading...',
	'confirm' : 'OK',
	'cancel' : 'Cancel',
	'notice' : 'Notice',
	'close' : 'close',
	'rediect' : ' seconds...'	
};
BROWSER.opera = BROWSER.opera ? opera.version() : 0;
function browserVersion(types) {
	var other = 1;
	for(i in types) {
		var v = types[i] ? types[i] : i;
		if(USERAGENT.indexOf(v) != -1) {
			var re = new RegExp(v + '(\\/|\\s|:)([\\d\\.]+)', 'ig');
			var matches = re.exec(USERAGENT);
			var ver = matches != null ? matches[2] : 0;
			other = ver !== 0 && v != 'mozilla' ? 0 : other;
		}else {
			var ver = 0;
		}
		eval('BROWSER.' + i + '= ver');
	}
	BROWSER.other = other;
}


;(function(OKW){
	if (OKW == undefined)
	{
		OKW = window._OPT = {
				apiCache : {},
				extend : function(name,n,override){
					var o=this;
					if (o[name] != undefined)return o;
					o[name] = {};
				   for(var p in n)if(n.hasOwnProperty(p) && (!o.hasOwnProperty(p) || override))o[name][p]=n[p];
				   return o;
				},
				forEach : function(arr,cb){
					if (Object.prototype.toString.call(arr) == "[object Object]")
					{
						for(var i in arr){if(arr.hasOwnProperty(i) && typeof cb=='function')cb(i,arr[i])}
					}
					else if (Object.prototype.toString.call(arr) == "[object Array]")
					{
						if(typeof cb!='function'){throw new TypeError()};for(var i=0;i!=arr.length;++i){cb(i,arr[i])}
					}
				},
				api : function(action,cb,data,type,overWriteCache,debug)
				{
					if (action[0]=="/"){action=action.substring(1);}
					if (action[action.length-1]=="/"){action=action.substring(0,action.length-1);}
					type = type==undefined ? 'get' : type;
					overWriteCache = overWriteCache == undefined ? 0 : 1;
					debug = debug == undefined ? 0 : 1;
					var arr = action.split("/");
					var dataStr = '';

					if (data != undefined)
					{
						_OPT.forEach(data,function(k,v){
							dataStr += k+"="+v+"|";
						});
					}
					
					var cacheKey = action+type+dataStr;
					
					var cb1 = function(ret){
						if (OKW.apiCache[cacheKey] == undefined || overWriteCache)
						{	
							OKW.apiCache[cacheKey] = ret;
						}
						try{
							eval("ret = "+ret);
						}catch(e){};
						
						cb(ret);
					}
					if (OKW.apiCache[cacheKey] != undefined && overWriteCache==0)
					{
						cb1(OKW.apiCache[cacheKey]);return;
					}

					data['inajax']=1;	
					 $.ajax({
						type : type,
						data:data,
						url : +(arr[0]!=undefined ? arr[0] : data['c'])+"/"+(arr[1]!=undefined ? arr[1] : data['a']),
						dataType : 'text',
						success : cb1
					 });
				}
			};
	}
})(window._OPT);

/**
 * 动态加载css，js
 * 
 * 加载 /js/extend.js 并执行里面的函数 extend_fun, 传入参数'a','b'     function extend_fun(a,b){alert(a);alert(b);}
 * 	_OPT.load.F("fun",['a','b']);  
 * 加载此js
 * _OPT.load.appendscript("http://web.kuaiwan.com/themes/js/jquery-1.4.3.min.js");		
 * 将文本解析为能运行的js
 * _OPT.load.evalscript("<script>alert(1)</script>");	
 * 解析css 字符串，运行下面代码 整个背景将会变红
 * _OPT.load.evalcss("body{background:red}");
 * 引入css文件
 * _OPT.load.appendcss("http://xxx.css"); 
 * */
_OPT.extend('load',(function(){return{JSLOADED:[],evalscripts:[],VERHASH:CONFIG.DEBUG?Math.random():'1',JSPATH:CONFIG.MEDIA+"/js",defaultJS:'extend',in_array:function(needle,haystack){if(typeof needle=='string'||typeof needle=='number'){for(var i in haystack){if(haystack[i]==needle){return true}}};return false},D:function(id){return!id?null:document.getElementById(id)},evalscript:function(s){if(s.indexOf('<script')==-1)return s;var p=/<script[^\>]*?>([^\x00]*?)<\/script>/ig;var arr=[];while(arr=p.exec(s)){var p1=/<script[^\>]*?src=\"([^\>]*?)\"[^\>]*?(reload=\"1\")?(?:charset=\"([\w\-]+?)\")?><\/script>/i;var arr1=[];arr1=p1.exec(arr[0]);if(arr1){this.appendscript(arr1[1],'',arr1[2],arr1[3])}else{p1=/<script(.*?)>([^\x00]+?)<\/script>/i;arr1=p1.exec(arr[0]);this.appendscript('',arr1[2],arr1[1].indexOf('reload=')!=-1)}};return s},hash:function(string,length){var length=length?length:32;var start=0;var i=0;var result='';filllen=length-string.length%length;for(i=0;i<filllen;i++){string+="0"}while(start<string.length){result=this.stringxor(result,string.substr(start,length));start+=length};return result},stringxor:function(s1,s2){var s='';var hash='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';var max=Math.max(s1.length,s2.length);for(var i=0;i<max;i++){var k=s1.charCodeAt(i)^s2.charCodeAt(i);s+=hash.charAt(k%52)};return s},appendscript:function(src,text,reload,charset){var id=this.hash(src+text);if(!reload&&this.in_array(id,this.evalscripts))return;if(reload&&this.D(id)){this.D(id).parentNode.removeChild(this.D(id))};this.evalscripts.push(id);var scriptNode=document.createElement("script");scriptNode.type="text/javascript";scriptNode.id=id;scriptNode.charset=charset?charset:(document.all?document.charset:document.characterSet);try{if(src){scriptNode.src=src;scriptNode.onloadDone=false;scriptNode.onload=function(){scriptNode.onloadDone=true;_OPT.load.JSLOADED[src]=1};scriptNode.onreadystatechange=function(){if((scriptNode.readyState=='loaded'||scriptNode.readyState=='complete')&&!scriptNode.onloadDone){scriptNode.onloadDone=true;_OPT.load.JSLOADED[src]=1}}}else if(text){scriptNode.text=text};document.getElementsByTagName('head')[0].appendChild(scriptNode)}catch(e){}},F:function(func,args,fileName,path,debug){if(typeof mod==undefined){return false};if(path==undefined||typeof path==undefined){path=this.JSPATH};if(fileName==undefined||typeof fileName==undefined){fileName=this.defaultJS};var pre=fileName.toString().toLocaleLowerCase();var run=function(){var argc=args.length,s='';for(i=0;i<argc;i++){s+=',args['+i+']'};eval('var check = typeof '+pre+'_'+func+' == \'function\'');if(debug)console.log('var check = typeof '+pre+'_'+func+' == \'function\'');if(check){eval(pre+'_'+func+'('+s.substr(1)+')');if(debug)console.log(pre+'_'+func+'('+s.substr(1)+')')}else{setTimeout(function(){checkrun()},50)}};var checkrun=function(){if(_OPT.load.JSLOADED[src]){run()}else{setTimeout(function(){checkrun()},50)}};src=this.JSPATH+"/"+fileName+".js?"+this.VERHASH;if(!this.JSLOADED[src]){this.appendscript(src)};checkrun()},appendcss:function(href){var ls=document.getElementsByTagName("link");for(i=0;i<ls.length;i++){if(ls[i].href&&ls[i].href.indexOf(href)!=-1)return ls[i]};s=document.createElement("link");s.rel="stylesheet";s.type="text/css";s.href=href;s.disabled=false;document.getElementsByTagName("head")[0].appendChild(s)},evalcss:function(css){if(!-[1,]){css=css.replace(/opacity:\s*(\d?\.\d+)/g,function($,$1){$1=parseFloat($1)*100;if($1<0||$1>100)return"";return"filter:alpha(opacity="+$1+");"})};css+="\n";var doc=document,head=doc.getElementsByTagName("head")[0],styles=head.getElementsByTagName("style"),style,media;if(styles.length==0){if(doc.createStyleSheet){doc.createStyleSheet()}else{style=doc.createElement('style');style.setAttribute("type","text/css");head.insertBefore(style,null)}};style=styles[0];media=style.getAttribute("media");if(media===null&&!/screen/i.test(media)){style.setAttribute("media","all")};if(style.styleSheet){style.styleSheet.cssText+=css}else if(doc.getBoxObjectFor){style.innerHTML+=css}else{style.appendChild(doc.createTextNode(css))}}}})());
_OPT.extend("ui",function(j,y){return{JSMENU:{active:[],timer:[],drag:[],layer:0,zIndex:{win:200,menu:300,dialog:400,prompt:500},"float":""},EXTRAFUNC:{showmenu:[]},EXTRASTR:"",getEvent:function(){if(document.all)return window.event;for(func=this.getEvent.caller;null!=func;){var a=func.arguments[0];if(a&&(a.constructor==Event||a.constructor==MouseEvent||"object"==typeof a&&a.preventDefault&&a.stopPropagation))return a;func=func.caller}return null},D:function(a){return j.D(a)},doane:function(a,b,d){b=isUndefined(b)?1:b;d=isUndefined(d)?1:d;(e=a?a:window.event)||(e=this.getEvent());if(!e)return null;b&&(e.preventDefault?e.preventDefault():e.returnValue=!1);d&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0);return e},setMenuPosition:function(a,b,d){var g=this.D,c="object"==typeof a?g(a.ctrlid):g(a),a=b?g(b):g(a+"_menu"),d=d.toString();if(isUndefined(d)||!d)d="43";var b=parseInt(d.substr(0,1)),g=parseInt(d.substr(1,1)),l=parseInt(d.substr(2,1)),f=-1!=d.indexOf("!")?1:0,m=0,j=0,r=m=0,n=0,k=0,h=0,s=0,t=0,p=0,q=0;if(a&&(!(0<b)||c)){c&&(m=fetchOffset(c),j=m.left,m=m.top,r=c.offsetWidth,n=c.offsetHeight);s=a.offsetWidth;t=a.offsetHeight;switch(b){case 1:p=j;q=m;break;case 2:p=j+r;q=m;break;case 3:p=j+r;q=m+n;break;case 4:p=j,q=m+n}switch(g){case 0:a.style.left=(document.body.clientWidth-a.clientWidth)/2+"px";h=(document.documentElement.clientHeight-a.clientHeight)/2;break;case 1:k=p-s;h=q-t;break;case 2:k=p;h=q-t;break;case 3:k=p;h=q;break;case 4:k=p-s,h=q}var v=Math.max(document.documentElement.scrollTop,document.body.scrollTop),u=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft);f||((in_array(g,[1,4])&&0>k?(k=p,in_array(b,[1,4])&&(k+=r)):k+s>u+document.body.clientWidth&&j>=s&&(k=p-s,in_array(b,[2,3])?k-=r:4==b&&(k+=r)),in_array(g,[1,2])&&0>h)?(h=q,in_array(b,[1,2])&&(h+=n)):h+t>v+document.documentElement.clientHeight&&m>=t&&(h=q-t,in_array(b,[3,4])&&(h-=n)));"210"==d.substr(0,3)&&(k+=69-r/2,h-=5,"TEXTAREA"==c.tagName&&(k-=r/2,h+=n/2));if(0==g||a.scrolly)BROWSER.ie&&7>BROWSER.ie?0==g&&(h+=v):(a.scrolly&&(h-=v),a.style.position=1==l?"absolute":"fixed");k&&(a.style.left=k+"px");h&&(a.style.top=h+"px");0==g&&(BROWSER.ie&&!document.documentElement.clientHeight)&&(a.style.position="absolute",a.style.top=(document.body.clientHeight-a.clientHeight)/2+"px");a.style.clip&&!BROWSER.opera&&(a.style.clip="rect(auto, auto, auto, auto)")}},hideMenu:function(a,b){var d=this.JSMENU,a=isUndefined(a)?"":a,b=isUndefined(b)?"menu":b;if(""==a)for(var g=1;g<=this.JSMENU.layer;g++)hideMenu(g,b);else if("number"==typeof a)for(g in this.JSMENU.active[a])hideMenu(this.JSMENU.active[a][g],b);else if("string"==typeof a){var c=j.D(a);if(c&&!(b&&c.mtype!=b)){var l=g="";if((g=j.D(c.getAttribute("ctrlid")))&&(l=c.getAttribute("ctrlclass")))g.className=g.className.replace(RegExp(" "+l),"");clearTimeout(this.JSMENU.timer[a]);var f=function(){c.cache?"hidden"!=c.style.visibility&&(c.style.display="none",c.cover&&(j.D(a+"_cover").style.display="none")):(c.parentNode.removeChild(c),c.cover&&j.D(a+"_cover").parentNode.removeChild(j.D(a+"_cover")));var b=[],f;for(f in d.active[c.layer])a!=d.active[c.layer][f]&&b.push(d.active[c.layer][f]);d.active[c.layer]=b};if(c.fade){var m=function(a){if(0==a)clearTimeout(b),f();else{c.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+a+")";c.style.opacity=a/100;var a=a-20,b=setTimeout(function(){m(a)},40)}};m(100)}else f()}}},showMenu:function(a){var b=this.JSMENU,d=isUndefined(a.ctrlid)?a:a.ctrlid,g=isUndefined(a.showid)?d:a.showid,c=isUndefined(a.menuid)?g+"_menu":a.menuid;if("string"==typeof d)var l=j.D(d);var f=j.D(c);if(f){var m=isUndefined(a.mtype)?"menu":a.mtype,z=isUndefined(a.evt)?"mouseover":a.evt,r=isUndefined(a.pos)?"43":a.pos,n=isUndefined(a.layer)?1:a.layer,k=isUndefined(a.duration)?2:a.duration,h=isUndefined(a.timeout)?250:a.timeout,s=isUndefined(a.maxh)?600:a.maxh,t=isUndefined(a.cache)?1:a.cache,p=isUndefined(a.drag)?"":a.drag,q=p&&j.D(p)?j.D(p):f,v=isUndefined(a.fade)?0:a.fade,u=isUndefined(a.cover)?0:a.cover,w=isUndefined(a.zindex)?b.zIndex.menu:a.zindex,x=isUndefined(a.ctrlclass)?"":a.ctrlclass;(a=isUndefined(a.win)?"":a.win)&&(l&&!l.getAttribute("fwin"))&&l.setAttribute("fwin",a);w=u?w+500:w;"undefined"==typeof this.JSMENU.active[n]&&(this.JSMENU.active[n]=[]);for(i in this.EXTRAFUNC.showmenu)try{eval(this.EXTRAFUNC.showmenu[i]+"()")}catch(B){}if("click"==z&&in_array(c,this.JSMENU.active[n])&&"win"!=m)this.hideMenu(c,m);else{"menu"==m&&this.hideMenu(n,m);l&&!l.getAttribute("initialized")&&(l.setAttribute("initialized",!0),l.unselectable=!0,l.outfunc="function"==typeof l.onmouseout?l.onmouseout:null,l.onmouseout=function(){this.outfunc&&this.outfunc();3>k&&!b.timer[c]&&(b.timer[c]=setTimeout(function(){this.hideMenu(c,m)},h))},l.overfunc="function"==typeof l.onmouseover?l.onmouseover:null,l.onmouseover=function(a){y.ui.doane(a);this.overfunc&&this.overfunc();if("click"==z)clearTimeout(b.timer[c]),b.timer[c]=null;else for(var d in b.timer)b.timer[d]&&(clearTimeout(b.timer[d]),b.timer[d]=null)});if(!f.getAttribute("initialized")){f.setAttribute("initialized",!0);f.ctrlkey=d;f.mtype=m;f.layer=n;f.cover=u;l&&l.getAttribute("fwin")&&(f.scrolly=!0);f.style.position="absolute";f.style.zIndex=w+n;f.onclick=function(a){return y.ui.doane(a,0,1)};if(3>k&&(1<k&&(f.onmouseover=function(){clearTimeout(b.timer[c]);b.timer[c]=null}),1!=k))f.onmouseout=function(){b.timer[c]=setTimeout(function(){hideMenu(c,m)},h)};if(u){var o=j.D(c+"_cover");o?o.style.display="none":(o=document.createElement("div"),o.id=c+"_cover",o.style.position="absolute",o.style.zIndex=f.style.zIndex-1,o.style.left=o.style.top="0px",o.style.width="100%",o.style.height=Math.max(document.documentElement.clientHeight,document.body.offsetHeight)+"px",o.style.backgroundColor="#000",o.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=50)",o.style.opacity=0.5,o.onclick=function(){hideMenu()},document.body.appendChild(o),_attachEvent(window,"load",function(){o.style.height=Math.max(document.documentElement.clientHeight,document.body.offsetHeight)+"px"},document))}}p&&(q.style.cursor="move",q.onmousedown=function(a){try{this.dragMenu(f,a,1)}catch(b){}});u&&(j.D(c+"_cover").style.display="");if(v){var A=function(a){if(a>100)clearTimeout(b);else{f.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+a+")";f.style.opacity=a/100;var a=a+20,b=setTimeout(function(){A(a)},40)}};A(0);f.fade=!0}else f.fade=!1;f.style.display="";l&&x&&(l.className+=" "+x,f.setAttribute("ctrlid",d),f.setAttribute("ctrlclass",x));"*"!=r&&this.setMenuPosition(g,c,r);BROWSER.ie&&(7>BROWSER.ie&&a&&j.D("fwin_"+a))&&(j.D(c).style.left=parseInt(j.D(c).style.left)-parseInt(j.D("fwin_"+a).style.left)+"px",j.D(c).style.top=parseInt(j.D(c).style.top)-parseInt(j.D("fwin_"+a).style.top)+"px");s&&f.scrollHeight>s&&(f.style.height=s+"px",BROWSER.opera?f.style.overflow="auto":f.style.overflowY="auto");k||setTimeout("hideMenu('"+c+"', '"+m+"')",h);in_array(c,this.JSMENU.active[n])||this.JSMENU.active[n].push(c);f.cache=t;n>this.JSMENU.layer&&(this.JSMENU.layer=n)}}},delayShowST:null,delayShow:function(a,b,d){if("object"==typeof a)var g=a.id,b=b||function(){showMenu(g)};d=isUndefined(d)?500:d;delayShowST=setTimeout(function(){"function"==typeof b?b():eval(b)},d);a.delayinit||(_attachEvent(a,"mouseout",function(){clearTimeout(delayShowST)}),a.delayinit=1)},dragMenuDisabled:!1,dragMenu:function(a,b,d){b=b?b:window.event;JSMENU=_OPT.ui.JSMENU;if(1==d){if(!this.dragMenuDisabled&&!in_array(b.target?b.target.tagName:b.srcElement.tagName,["TEXTAREA","INPUT","BUTTON","SELECT"])){JSMENU.drag=[b.clientX,b.clientY];JSMENU.drag[2]=parseInt(a.style.left);JSMENU.drag[3]=parseInt(a.style.top);var g=this.dragMenu;document.onmousemove=function(b){g(a,b,2)};document.onmouseup=function(b){try{g(a,b,3)}catch(d){}};this.doane(b)}}else 2==d&&JSMENU.drag[0]?(d=[b.clientX,b.clientY],a.style.left=JSMENU.drag[2]+d[0]-JSMENU.drag[0]+"px",a.style.top=JSMENU.drag[3]+d[1]-JSMENU.drag[1]+"px",a.removeAttribute("top_"),a.removeAttribute("left_"),_OPT.ui.doane(b)):3==d&&(this.JSMENU.drag=[],document.onmousemove=null,document.onmouseup=null)}}}(_OPT.load,window._OPT));
_OPT.extend("request",function(e,n){return{Ajax:function(b,c){var a={};a.loading=MessageJS.wating;a.recvType=b?b:"XML";a.waitId=c?e.D(c):null;a.resultHandle=null;a.sendString="";a.targetUrl="";a.setLoading=function(b){"undefined"!==typeof b&&null!==b&&(a.loading=b)};a.setRecvType=function(b){a.recvType=b};a.setWaitId=function(b){a.waitId="object"==typeof b?b:e.D(b)};a.createXMLHttpRequest=function(){var a=!1;if(window.XMLHttpRequest)a=new XMLHttpRequest,a.overrideMimeType&&a.overrideMimeType("text/xml");else if(window.ActiveXObject)for(var b="Microsoft.XMLHTTP MSXML.XMLHTTP Microsoft.XMLHTTP Msxml2.XMLHTTP.7.0 Msxml2.XMLHTTP.6.0 Msxml2.XMLHTTP.5.0 Msxml2.XMLHTTP.4.0 MSXML2.XMLHTTP.3.0 MSXML2.XMLHTTP".split(" "),c=0;c<b.length;c++)try{if(a=new ActiveXObject(b[c]))return a}catch(d){}return a};a.XMLHttpRequest=a.createXMLHttpRequest();a.showLoading=function(){if(a.waitId&&(4!=a.XMLHttpRequest.readyState||200!=a.XMLHttpRequest.status))a.waitId.style.display="",a.waitId.innerHTML='<span><img src="'+IMAGES.loading+'" class="vm"> '+a.loading+"</span>"};a.processHandle=function(){if(4==a.XMLHttpRequest.readyState&&200==a.XMLHttpRequest.status)if(a.waitId&&(a.waitId.style.display="none"),"HTML"==a.recvType)a.resultHandle(a.XMLHttpRequest.responseText,a);else if("XML"==a.recvType)!a.XMLHttpRequest.responseXML||!a.XMLHttpRequest.responseXML.lastChild||"parsererror"==a.XMLHttpRequest.responseXML.lastChild.localName?a.resultHandle('<a href="'+a.targetUrl+'" target="_blank" style="color:red">'+MessageJS.sysError500+"</a>",a):a.resultHandle(a.XMLHttpRequest.responseXML.lastChild.firstChild.nodeValue,a);else if("JSON"==a.recvType){var b=null;try{b=(new Function("return ("+a.XMLHttpRequest.responseText+")"))()}catch(c){b=null}a.resultHandle(b,a)}};a.get=function(b,c){setTimeout(function(){a.showLoading()},250);a.targetUrl=b;a.XMLHttpRequest.onreadystatechange=a.processHandle;a.resultHandle=c;var f=isUndefined(f)?0:f;window.XMLHttpRequest?(a.XMLHttpRequest.open("GET",a.targetUrl),a.XMLHttpRequest.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.XMLHttpRequest.send(null)):(a.XMLHttpRequest.open("GET",b,!0),a.XMLHttpRequest.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.XMLHttpRequest.send())};a.post=function(b,c,f){setTimeout(function(){a.showLoading()},250);a.targetUrl=b;a.sendString=c;a.XMLHttpRequest.onreadystatechange=a.processHandle;a.resultHandle=f;a.XMLHttpRequest.open("POST",b);a.XMLHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.XMLHttpRequest.setRequestHeader("X-Requested-With","XMLHttpRequest");a.XMLHttpRequest.send(a.sendString)};a.getJSON=function(b,c){a.setRecvType("JSON");a.get(b+"&ajaxdata=json",c)};a.getHTML=function(b,c){a.setRecvType("HTML");a.get(b+"&ajaxdata=html",c)};return a},ajaxget:function(b,c,a,h,i,f){var d=n.request.Ajax,a="undefined"==typeof a||null===a?c:a,d=new d;d.setLoading(h);d.setWaitId(a);d.display="undefined"==typeof i||null==i?"":i;d.showId=e.D(c);"#"==b.substr(strlen(b)-1)&&(b=b.substr(0,strlen(b)-1),d.autogoto=1);-1==b.indexOf("?")&&(b+="?");d.get(b+"&inajax=2&ajaxtarget="+c,function(a,b){var c=false;if(a.indexOf("ajaxerror")!=-1){_OPT.load.evalscript(a);c=true}if(!c&&(typeof ajaxerror=="undefined"||!ajaxerror)&&b.showId){b.showId.style.display=b.display;n.request.ajaxinnerhtml(b.showId,a);n.request.ajaxupdateevents(b.showId);b.autogoto&&scroll(0,b.showId.offsetTop)}ajaxerror=null;f&&typeof f=="function"?f():f&&eval(f);c||_OPT.load.evalscript(a)})},ajaxupdateevents:function(b,c){var a=b.getElementsByTagName(c?c:"A");for(k in a)n.request.ajaxupdateevent(a[k])},ajaxinnerhtml:function(b,c){if("TBODY"!=b.tagName)b.innerHTML=c;else{for(;b.firstChild;)b.firstChild.parentNode.removeChild(b.firstChild);var a=document.createElement("DIV");a.id=b.id+"_div";a.innerHTML='<table><tbody id="'+b.id+'_tbody">'+c+"</tbody></table>";document.body.appendChild(a);for(var e=a.getElementsByTagName("TR"),i=e.length,f=0;f<i;f++)b.appendChild(e[0]);e=a.getElementsByTagName("INPUT");i=e.length;for(f=0;f<i;f++)b.appendChild(e[0]);a.parentNode.removeChild(a)}},ajaxupdateevent:function(b){if("object"==typeof b&&b.getAttribute&&b.getAttribute("ajaxtarget")){b.id||(b.id=Math.random());var c=b.getAttribute("ajaxevent")?b.getAttribute("ajaxevent"):"click",a=b.getAttribute("ajaxurl")?b.getAttribute("ajaxurl"):b.href;_attachEvent(b,c,newfunction("ajaxget",a,b.getAttribute("ajaxtarget"),b.getAttribute("ajaxwaitid"),b.getAttribute("ajaxloading"),b.getAttribute("ajaxdisplay")));b.getAttribute("ajaxfunc")&&(b.getAttribute("ajaxfunc").match(/(\w+)\((.+?)\)/),_attachEvent(b,c,newfunction(RegExp.$1,RegExp.$2)))}},ajaxpost:function(b,c,a,h,i,f){var h=!h?"":h,d=e.D("ajaxframe"),g=e.D(b),l=g.target;if(d){if(d.loading)return!1}else b=document.createElement("div"),b.style.display="none",b.innerHTML='<iframe name="ajaxframe" id="ajaxframe" loading="1"></iframe>',e.D("append_parent").appendChild(b),d=e.D("ajaxframe");jQuery(d).bind("load",function(){var a="",b=!1;showloading("none");try{a=e.D("ajaxframe").contentWindow.document.XMLDocument.text}catch(o){try{a=e.D("ajaxframe").contentWindow.document.documentElement.firstChild.wholeText}catch(n){try{a=e.D("ajaxframe").contentWindow.document.documentElement.firstChild.nodeValue}catch(q){a=MessageJS.sysError500}}}""!=a&&-1!=a.indexOf("ajaxerror")&&(_OPT.load.evalscript(a),b=!0);h&&("onerror"!=h?e.D(c).className=h:(showError(a),ajaxerror=!0));i&&(i.disabled=!1);!b&&(c&&("undefined"==typeof ajaxerror||!ajaxerror))&&ajaxinnerhtml(e.D(c),a);ajaxerror=null;g&&(g.target=l);"function"==typeof f?f():eval(f);b||_OPT.load.evalscript(a);d.loading=0;!BROWSER.firefox||BROWSER.safari?e.D("append_parent").removeChild(d.parentNode):setTimeout(function(){e.D("append_parent").removeChild(d.parentNode)},100)});showloading();g.target="ajaxframe";b=g.getAttribute("action");b=-1==b.indexOf("?")?b+"?":b+"&";g.action=(b+"inajax=2").replace(/inajax\=2/g,"")+"inajax=2";g.submit();i&&(i.disabled=!0);doane();return!1},ajaxmenu:function(b,c,a,h,i,f,d,g){if(b.getAttribute("mid"))l=b.getAttribute("mid"),b.id||(b.id="ajaxid_"+Math.random());else{var l=b.id;l||(b.id="ajaxid_"+Math.random())}var j=l+"_menu",m=e.D(j);isUndefined(c)&&(c=3E3);isUndefined(a)&&(a=1);isUndefined(i)&&(i="43");isUndefined(h)&&(h=0<c?0:3);isUndefined(d)&&(d="p_pop");isUndefined(g)&&(g="p_opt");l=function(){showMenu({ctrlid:b.id,menuid:j,duration:h,timeout:c,pos:i,cache:a,layer:2});"function"==typeof f?f():eval(f)};m?""==m.style.display?hideMenu(j):l():(m=document.createElement("div"),m.id=j,m.style.display="none",m.className=d,m.innerHTML='<div class="'+g+'" id="'+j+'_content"></div>',e.D("append_parent").appendChild(m),d=!isUndefined(b.attributes.shref)?b.attributes.shref.value:!isUndefined(b.href)?b.href:b.attributes.href.value,d+=(-1!=d.indexOf("?")?"&":"?")+"ajaxmenu=1",ajaxget(d,j+"_content","ajaxwaitid","","",l));doane()},showWindow:function(b,c,a,h,i){var f=e.D,a=isUndefined(a)?"get":a,h=isUndefined(h)?1:h,d="fwin_"+b,g=f(d),l=null,j=null,f="",m=this.ajaxget,o=this.ajaxpost,p=function(){"get"==a?(g.url=c,c+=(0<c.search(/\?/)?"&":"?")+"infloat=yes&handlekey="+b,c+=-1==h?"&t="+ +new Date:"",BROWSER.ie&&0>c.indexOf("referer=")&&(c=c+"&referer="+encodeURIComponent(location)),m(c,"fwin_content_"+b,null,"","",function(){q();r()})):"post"==a&&(g.act=e.D(c).action,o(c,"fwin_content_"+b,"","","",function(){q();r()}));6!=parseInt(BROWSER.ie)&&(j=setTimeout(function(){},500))},q=function(){clearTimeout(j);for(var a=g.getElementsByTagName("*"),c=!1,d=0;d<a.length;d++)if(a[d].id&&a[d].setAttribute("fwin",b),"flbc"==a[d].className&&(a[d].href="javascript:hideWindow('"+b+"');"),"flb"==a[d].className&&!c)a[d].id||(a[d].id="fctrl_"+b),l=a[d].id,c=!0},r=function(){hideMenu("fwin_dialog","dialog");v={mtype:"win",menuid:d,duration:3,pos:"00",zindex:n.ui.JSMENU.zIndex.win,drag:null==typeof l?"":l,cache:h,cover:0};for(b in i)v[b]=i[b];n.ui.showMenu(v)};if(g)"get"==a&&(c!=g.url||1!=h)||"post"==a&&e.D(c).action!=g.act?p():r();else{g=document.createElement("div");g.id=d;g.className="fwinmask";g.style.display="none";document.body.appendChild(g);evt=' style="cursor:move" onmousedown="_OPT.ui.dragMenu(_OPT.load.D(\''+d+"'), event, 1)\" ondblclick=\"hideWindow('"+b+"')\"";BROWSER.ie||(f='<style type="text/css">object{visibility:hidden;}</style>');var s=d+"_close";css="#"+s+"{position:relative}#"+s+" .showwindowclose{position:absolute;top:0;right:0;color:#FFF;}";e.evalcss(css);evt1="onclick=\"hideWindow('"+b+"')\"";g.innerHTML=f+'<div id="'+d+'_close" class="fwin_close"><a href="javascript:;" class="showwindowclose" '+evt1+'>close</a><table cellpadding="0" cellspacing="0" class="fwin"><tr><td class="t_l"></td><td class="t_c"'+evt+'></td><td class="t_r"></td></tr><tr><td class="m_l"'+evt+'></td><td class="m_c" id="fwin_content_'+b+'"></td><td class="m_r"'+evt+'></td></tr><tr><td class="b_l"></td><td class="b_c"'+evt+'></td><td class="b_r"></td></tr></table></div>';"html"==a?(e.D("fwin_content_"+b).innerHTML=c,q(),r()):p()}n.ui.doane()},hideWindow:function(b,c,a){c=isUndefined(c)?1:c;a=isUndefined(a)?1:a;hideMenu("fwin_"+b,"win");a&&e.D("fwin_"+b)&&e.D("fwin_"+b).parentNode.removeChild(e.D("fwin_"+b));c&&hideMenu()},showDialogST:null,showDialog:function(b,c,a,h,i,f,d,g,l,j,m){clearTimeout(this.showDialogST);var i=isUndefined(i)?"info"==c?0:1:i,d=isUndefined(d)?"":d,c=in_array(c,["confirm","notice","info","right"])?c:"alert",o=e.D("fwin_dialog"),p=1;confirmtxtdefault=MessageJS.confirm;j=isUndefined(j)?"":j;closefunc=function(){"function"==typeof h?h():eval(h);hideMenu("fwin_dialog","dialog")};if(j)showPrompt(null,null,"<i>"+b+"</i>",1E3*j,"popuptext");else{if(m=isUndefined(m)?"":m)d=m+MessageJS.rediect,showDialogST=setTimeout(closefunc,1E3*m),p=0;g=g?g:confirmtxtdefault;l=l?l:MessageJS.cancel;o&&hideMenu("fwin_dialog","dialog");o=document.createElement("div");o.style.display="none";o.className="fwinmask";o.id="fwin_dialog";document.body.appendChild(o);j="";BROWSER.ie||(j='<style type="text/css">object{visibility:hidden;}</style>');a=j+'<table cellpadding="0" cellspacing="0" class="fwin"><tr><td class="t_l"></td><td class="t_c"></td><td class="t_r"></td></tr><tr><td class="m_l"></td><td class="m_c"><h3 class="flb"><em>'+(a?a:MessageJS.notice);a+='</em><span><a href="javascript:;" id="fwin_dialog_close" class="flbc" onclick="hideMenu(\'fwin_dialog\', \'dialog\')" title="'+MessageJS.close+'">'+MessageJS.close+"</a></span></h3>";o.innerHTML=a+('<div class="c altw"><div class="'+("alert"==c?"alert_error":"right"==c?"alert_right":"alert_info")+'"><p>'+b+"</p></div></div>")+('<p class="o pns">'+(d?'<span class="z xg1">'+d+"</span>":"")+(p?'<button id="fwin_dialog_submit" value="true" class="pn pnc"><strong>'+g+"</strong></button>":""))+("confirm"==c?'<button id="fwin_dialog_cancel" value="true" class="pn" onclick="hideMenu(\'fwin_dialog\', \'dialog\')"><strong>'+l+"</strong></button>":"")+'</p></td><td class="m_r"></td></tr><tr><td class="b_l"></td><td class="b_c"></td><td class="b_r"></td></tr></table>';e.D("fwin_dialog_submit")&&(e.D("fwin_dialog_submit").onclick=function(){"function"==typeof h?h():eval(h);hideMenu("fwin_dialog","dialog")});e.D("fwin_dialog_cancel")&&(e.D("fwin_dialog_cancel").onclick=function(){typeof f=="function"?f():eval(f);hideMenu("fwin_dialog","dialog")},e.D("fwin_dialog_close").onclick=e.D("fwin_dialog_close").onclick);n.ui.showMenu({mtype:"dialog",menuid:"fwin_dialog",duration:3,pos:"00",zindex:n.ui.JSMENU.zIndex.dialog,cache:0,cover:i});try{e.D("fwin_dialog_submit").focus()}catch(q){}}}}}(_OPT.load,window._OPT));
/**
 * 模拟alert弹出框
 * @param msg		string	弹出内容
 * @param title		string	标题信息
 * @param button	json	按钮个数，以及按钮点击后触发的时间
 * @param timeout	int		定时关闭时间
 * @param width		int		弹出框宽度
 * @param height	int		弹出框高度
 */
function showMsg(msg,title,button,timeout,width,height){_OPT.load.F('showmsg',arguments,'jqueryui');}
/**
 * 页面弹窗
 * @param div		html 元素的标签 或者 是id
 * @param title		提示信息的标题
 * @param param
 */
function dialog(id,param){_OPT.load.F('dialog',arguments,'jqueryui');}
function dialogContent(id,html){_OPT.load.F('dialogChangeContent',arguments,'jqueryui');}



function hideMenu(attr, mtype)
{
	_OPT.ui.hideMenu(attr, mtype);
}

//_OPT.extend('ui',(function($,OPT){return {}})(_OPT.load,window._OPT));


function delayShow(ctrlObj, call, time)
{
	_OPT.ui.delayShow(ctrlObj, call, time);
}
function showMenu(v)
{
	_OPT.ui.showMenu(v);
}

function getCurrentStyle(obj, cssproperty, csspropertyNS) {
	if(obj.style[cssproperty]){
		return obj.style[cssproperty];
	}
	if (obj.currentStyle) {
		return obj.currentStyle[cssproperty];
	} else if (document.defaultView.getComputedStyle(obj, null)) {
		var currentStyle = document.defaultView.getComputedStyle(obj, null);
		var value = currentStyle.getPropertyValue(csspropertyNS);
		if(!value){
			value = currentStyle[cssproperty];
		}
		return value;
	} else if (window.getComputedStyle) {
		var currentStyle = window.getComputedStyle(obj, "");
		return currentStyle.getPropertyValue(csspropertyNS);
	}
}
function fetchOffset(obj, mode) {
	var left_offset = 0, top_offset = 0, mode = !mode ? 0 : mode;

	if(obj.getBoundingClientRect && !mode) {
		var rect = obj.getBoundingClientRect();
		var scrollTop = Math.max(document.documentElement.scrollTop, document.body.scrollTop);
		var scrollLeft = Math.max(document.documentElement.scrollLeft, document.body.scrollLeft);
		if(document.documentElement.dir == 'rtl') {
			scrollLeft = scrollLeft + document.documentElement.clientWidth - document.documentElement.scrollWidth;
		}
		left_offset = rect.left + scrollLeft - document.documentElement.clientLeft;
		top_offset = rect.top + scrollTop - document.documentElement.clientTop;
	}
	if(left_offset <= 0 || top_offset <= 0) {
		left_offset = obj.offsetLeft;
		top_offset = obj.offsetTop;
		while((obj = obj.offsetParent) != null) {
			position = getCurrentStyle(obj, 'position', 'position');
			if(position == 'relative') {
				continue;
			}
			left_offset += obj.offsetLeft;
			top_offset += obj.offsetTop;
		}
	}
	return {'left' : left_offset, 'top' : top_offset};
}
function isUndefined(variable) {
	return typeof variable == 'undefined' ? true : false;
}
function in_array(needle, haystack) {
	if(typeof needle == 'string' || typeof needle == 'number') {
		for(var i in haystack) {
			if(haystack[i] == needle) {
					return true;
			}
		}
	}
	return false;
}

function getHost(url) {
	var host = "null";
	if(typeof url == "undefined"|| null == url) {
		url = window.location.href;
	}
	var regex = /^\w+\:\/\/([^\/]*).*/;
	var match = url.match(regex);
	if(typeof match != "undefined" && null != match) {
		host = match[1];
	}
	return host;
}

function hostconvert(url) {
	if(!url.match(/^https?:\/\//)) url = CONFIG.SITEURL + url;
	var url_host = getHost(url);
	var cur_host = getHost().toLowerCase();
	if(url_host && cur_host != url_host) {
		url = url.replace(url_host, cur_host);
	}
	return url;
}











/**
 * @param msg			信息内容
 * @param mode			模式，错误正确，还是info
 * @param t				标题
 * @param func			运行的函数
 * @param cover			遮罩层
 * @param funccancel	取消函数
 * @param leftmsg		
 * @param confirmtxt	按钮确定
 * @param canceltxt		按钮取消
 * @param closetime		tips显示模式
 * @param locationtime	延时跳转
 */
function showDialog(msg, mode, t, func, cover, funccancel, leftmsg, confirmtxt, canceltxt, closetime, locationtime) {
	_OPT.request.showDialog(msg, mode, t, func, cover, funccancel, leftmsg, confirmtxt, canceltxt, closetime, locationtime);
}

function showTip(ctrlobj) {
	_OPT.load.F('showTip', arguments,'showmessage');
}

function showPrompt(ctrlid, evt, msg, timeout, classname) {
	_OPT.load.F('showPrompt', arguments,'showmessage');
}



/*
 * ================================================================================================================
 * ================================================================================================================
 * ================================================================================================================
 * ================================================================================================================
 * ================================================================================================================
 */
function showWindow(k, url, mode, cache, menuv) {
	_OPT.request.showWindow(k, url, mode, cache, menuv);
}
function hideWindow(k, all, clear) {
	_OPT.request.hideWindow(k, all, clear);
}
function trim(str) {
	return (str + '').replace(/(\s+)$/g, '').replace(/^\s+/g, '');
}

function strlen(str) {
	return (BROWSER.ie && str.indexOf('\n') != -1) ? str.replace(/\r?\n/g, '_').length : str.length;
}
function mb_cutstr(str, maxlen, dot) {
	var len = 0;
	var ret = '';
	var dot = !dot ? '...' : dot;
	maxlen = maxlen - dot.length;
	for(var i = 0; i < str.length; i++) {
		len += str.charCodeAt(i) < 0 || str.charCodeAt(i) > 255 ? (charset == 'utf-8' ? 3 : 2) : 1;
		if(len > maxlen) {
			ret += dot;
			break;
		}
		ret += str.substr(i, 1);
	}
	return ret;
}
function mb_strlen(str) {
	var len = 0;
	for(var i = 0; i < str.length; i++) {
		len += str.charCodeAt(i) < 0 || str.charCodeAt(i) > 255 ? (charset == 'utf-8' ? 3 : 2) : 1;
	}
	return len;
}
//showMsg('xxxx');

function beatfulFrom(selector){_OPT.load.F('exec',arguments,'jquery_ezmark_min');}
function jquerySelect(selector){_OPT.load.F('init',arguments,'jquery_select_min');}
function datepicker(selector){_OPT.load.F('datepicker',arguments,'jquery_date_min');}
function zoom(obj, zimg, nocover, pn, showexif){_OPT.load.F('zoom',arguments,'zoom');}


function showlogin()
{
	_OPT.load.F('exec',arguments,'baofenglogin');
}